\documentclass[a4paper,12pt]{article}
\usepackage{amsmath}
\usepackage{pdfpages}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{fancyhdr}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{blue},
    numberstyle=\tiny\color{codegray},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}

\pagestyle{fancy}
\fancyhf{}
\lhead{Contol theory Homework \#5 report}
\rhead{Anton Brisilin, BS18-02 Student}
\fancyfoot[R]{\today}
\fancyfoot[C]{\thepage}
\renewcommand{\footrulewidth}{1pt}
\renewcommand{\headrulewidth}{1pt}

\begin{document}
\section{Task 1}
My name is \textit{Anton Brisilin}, and my email is 
\textit{a.brisilin@innopolis.university}, so my generated variant is \textbf{F}.

\section{Task 2}
First, lets obtain our new linearized system (with new coefficients).\\
From the previous assignment I obtained such nonlinear dynamics equation 
for the pendulum on a cart system:
\begin{equation*}
    \begin{bmatrix}
        \dot x\\
        \dot \theta\\
        \ddot x\\
        \ddot \theta    
    \end{bmatrix}
    =
    \begin{bmatrix}
        \dot x\\
        \dot \theta\\
        \frac
        {- mlsin(\theta)\dot \theta^2 + mgsin(\theta)cos(\theta)}
        {(M+m) - mcos^2(\theta)}\\
        \frac
        {(M+m)gsin(\theta) - mlcos(\theta)sin(\theta)\dot \theta^2}
        {l((M+m) - mcos^2(\theta))}
    \end{bmatrix}
    +
    \begin{bmatrix}
        0\\0\\
        \frac
        {1}
        {(M+m) - mcos^2(\theta)}\\
        \frac
        {cos(\theta)}
        {(M+m) - mcos^2(\theta)}
    \end{bmatrix}
    u
\end{equation*}
Just like in the previous assignment, I should linearize it by computing derivatives.
I will not pay too much attention to it, the script for computing derivatives is 
located as \texttt{Task2/diff.m}
\begin{equation}\label{linearized}
    \begin{bmatrix}
        \delta \dot x\\
        \delta \dot \theta\\
        \delta \dot x\\
        \delta \ddot \theta\\
    \end{bmatrix}
    =
    \begin{bmatrix}
        0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 1 \\
        0 & 0.7796 & 0 & 0\\
        0 & 30.256 & 0 & 0\\
    \end{bmatrix}
    +
    \begin{bmatrix}
        0\\
        0\\
        0.066\\
        0.066\\
    \end{bmatrix}
    u
\end{equation}
\subsection{Prove that it is possible to design state observer of the linearized
system}
In order to make possible existence of state observer, the observed system should
be fully observable.\\
To prove observability of the obtained system, I will use Principle of Duality.
It says, that if we have system
\begin{equation*}    
    \begin{cases}
        \dot x = Ax + Bu\\
        y = Cx + Du
    \end{cases}
\end{equation*}
then we can determine whether it is observable or not by considering controllability 
of its dual system, that is:
\begin{equation*}    
    \begin{cases}
        \dot z = A^*z + C^*k\\
        t = B^*z
    \end{cases}
\end{equation*}
where $A^*, B^*, C^*, D^*$ are conjugate transposes of matrices $A,B,C$ and $D$ respectively.
In our case $A$ and $B$ are same as in (\ref{linearized}). Matrix $C$ looks like this:
\begin{equation*}
    C=
    \begin{bmatrix}
        1 & 0 & 0 & 0\\
        0 & 1 & 0 & 0\\
        0 & 0 & 0 & 0\\
        0 & 0 & 0 & 0\\
    \end{bmatrix}
\end{equation*}
Thus, our conjugate transpose matrices are
\begin{equation*}
    \begin{cases}
        A^*= 
        \begin{bmatrix}
            0 & 0 & 0 & 0\\
            0 & 0 & 0.7796 & 30.256\\
            1 & 0 & 0 & 0\\
            0 & 1 & 0 & 0\\
        \end{bmatrix}\\
        B^*=
        \begin{bmatrix}
            0 & 0 &  0.066 & 0.066 
        \end{bmatrix}\\
        C^*=
        \begin{bmatrix}
            1 & 0 & 0 & 0\\
            0 & 1 & 0 & 0\\
            0 & 0 & 0 & 0\\
            0 & 0 & 0 & 0\\
        \end{bmatrix}\\
    \end{cases}
\end{equation*}
According to Ogata, "necessary and sufficient condition for complete observability [of my first system]
is that the rank of the $n\times nm$ matrix $[C^* | A^*C^* | \dots | (A^*)^{(n-1)}C^*]$
be $n$". Fortunately, Matlab has built-in function to check for controllability 
building controllability matrix. By checking its rank (that is 4 - the number of 
dimensions of $A$) with script in \texttt{Task2/contr.m}, we cane make conclusion,
that it is observable.

\section{Used software}
\begin{itemize}
    \item Python 3.8.1
    \item Matlab R2018b 9.5.0
    \item draw.io
\end{itemize}
All software was run under Manjaro Linux with 5.4.18-rt kernel
\end{document}